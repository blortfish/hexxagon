<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Untitled</title>

    <script type="text/javascript">
        /////////////////////////////////////////////////////////////////////////
        // init stuff
        // Global Constants
        //
        var KEY_LEFT = 74;//j
        var KEY_UP = 73;//i
        var KEY_RIGHT = 76; //l
        var KEY_DOWN = 75;//k
        var KEY_A = 65;
        var HOWMANY = 10;
        //
        // Globals
        //
        var lastKey = 0;
        var arr = new Array(); //Will be used to hold all of the
        var fighter;
        instances
        we
        make

        //This is where we actually create the objects, start our frame rate, and assign the key events
        function init() {
            //create a bunch of small images
            // Sprite(sn, imgSrc, width, height, left, top, dx)
            for (var i = 0; i < HOWMANY; i++) {
                arr[i] = new Sprite(i, 'picsmall.jpg', 33, 25, 0, (i * 25), (i + 1) % 20 + 1);
                arr[i].create();
            }

            fighter = new Fighter('f', 'pic.jpg');
            fighter.create();
            startTicker();
        }


        var win_width;

        //Get dimensions of the window (for bounce)
        function dimensions() {
            if (document.all) {
                win_width = document.body.clientWidth;
            } else {
                win_width = window.innerWidth;
            }

        }

        ////////////////////////////////////////////////////////////////////////////
        //important stuff!
        //Build a Sprite (OK - pretty simple object that we'll use to show how it works
        //and how to do inheritance, etc)


        //constructor
        function Sprite(sn, imgSrc, width, height, left, top, dx) {
            //ONLY STUFF IN HERE ARE INSTANCE VARS
            this.sn = sn;
            this.imgSrc = imgSrc;
            this.w = width;
            this.h = height;
            this.l = left;
            this.t = top;
            this.dx = dx;
            this.direction = 1;
        }

        Sprite.prototype.create = function () {
            document.getElementsByTagName('body')[0].appendChild(this.build());
        }

        Sprite.prototype.build = function () {
            //build visual rep in mem
            var imgE = document.createElement('img');
            imgE.id = 'Sprite_' + this.sn;
            imgE.style.position = 'absolute';
            imgE.style.top = this.t + "px";
            imgE.style.left = this.l + "px";
            imgE.style.width = this.w + "px";
            imgE.style.height = this.h + "px";
            imgE.src = this.imgSrc;

            imgE.onclick = function () {
                console.log(this.id);
            };
            return imgE;
        }

        Sprite.prototype.move = function () {
            //which one
            var dom = document.getElementById('Sprite_' + this.sn);
            //move

            if (this.dx > 0 && ( (this.l + this.w) < win_width || (this.dx < 0 && this.l > 0))) {
                this.l += this.dx;
                dom.style.left = this.l + 'px';
            }
            else {
                this.dx = this.dx * (-1);
            }
        }

        Sprite.prototype.PI = 3.141569;
        Sprite.prototype.DY = 4;

        //////////////////////////////////////////////////////////////////////
        //Let's build another object and inherit from the Sprite object!
        function Figher(sn, imgSrc) {
            this.sn = sn;
            this.imgSrc = imgSrc;
        }

        Fighter.prototype = new Sprite(this.sn, this.imgSrc, 134, 101, 300, 300, 4);

        Fighter.prototype = new Sprite();
        //////////////////////////////////////////////////////////////////////
        //Build a frame-rate timeline... (almost complete)
        //ticker function
        var ticker_id;

        //start it...
        function startTicker() {
            ticker_id = setInterval("ticker()", 20);
        }

        //stop it...
        function stopTicker() {
            clearInterval(ticker_id);
        }

        //This is my frame-rate
        function ticker() {
            processKey();
            //also need to move each instance (will complete later)
            for (var i = 0; i < HOWMANY; i++) {
                arr[i].move();
            }
        }
        ///////////////////////////////////////////////////////////////////////
        //Keyboard stuff - completed
        //
        //
        // NAME: keyDownEventHandler
        // DESCRIPTION: Handles keyboard events
        //
        function keyDownEventHandler(e) {
            var key = 0;
            (document.all) ? key = parseInt(event.keyCode) - 32 : key = parseInt(e.which) - 32;
            lastKey = key;
        }

        //
        // NAME: processKey
        // DESCRIPTION: Processes the key that was pressed
        //  			Called at the framerate
        //
        function processKey() {
            switch (lastKey) {
                case KEY_LEFT:
                    fighter.moveLeft();
                    break;
                case KEY_RIGHT:
                    fighter.moveRight();
                    break;
                case KEY_UP:
                    fighter.moveUp();
                    break;
                case KEY_DOWN:
                    fighter.moveDown();
                    break;
            }
        }
    </script>

</head>
<body onload="dimensions();init();" onresize="dimensions()">
</body>
</html>
